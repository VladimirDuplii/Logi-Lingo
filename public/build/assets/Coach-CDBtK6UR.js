import{r,j as e,H as v}from"./app-CB6H9fcf.js";import{D as N}from"./DuoLayout-1S1Fd3QP.js";import{R as w}from"./RightCourseSidebar-QTU9qcSS.js";import{u as S,P as h}from"./Toast-BdGrl3Cx.js";function k({auth:g}){const n=S(),[y,c]=r.useState(!0),[i,d]=r.useState(""),[l,b]=r.useState(null),[u,o]=r.useState(30),f=[10,20,30,40,50],[x,m]=r.useState(!1);r.useEffect(()=>{let s=!0;return(async()=>{try{c(!0),d("");const t=await h.getDailyQuests(),a=t?.data||t;if(!s)return;b(a),o(Number(a?.daily_goal_xp??30))}catch{s&&d("Не вдалося завантажити дані.")}finally{s&&c(!1)}})(),()=>{s=!1}},[]);const p=async()=>{const s=Math.max(10,Math.min(200,Number(u)||30));try{m(!0);const a=(await h.updateDailyGoal(s))?.data?.daily_goal_xp??s;o(a),n?.success("Щоденна ціль оновлена")}catch(t){const a=t?.response?.data?.message||t?.message||"Помилка збереження";n?.error(a)}finally{m(!1)}},j=e.jsx(w,{course:l?.active_course||null,hearts:l?.hearts,points:l?.points,otherCourses:g?.user?.courses||[]});return e.jsxs(N,{right:j,centerMaxClass:"xl:max-w-2xl",currentPath:"/settings/coach",children:[e.jsx(v,{title:"Daily Goal"}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Daily Goal"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Set how much XP you want to earn each day."})]}),e.jsx("div",{className:"rounded-xl border border-gray-200 bg-white p-6 shadow-sm",children:y?e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"mb-4 h-5 w-40 rounded bg-gray-200"}),e.jsx("div",{className:"h-10 w-64 rounded bg-gray-200"})]}):i?e.jsxs("div",{className:"flex items-center justify-between text-sm text-red-600",children:[e.jsx("span",{children:i}),e.jsx("button",{onClick:()=>window.location.reload(),className:"rounded border px-2 py-1 text-xs text-red-700 hover:bg-red-50",children:"Reload"})]}):e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Choose your daily XP goal"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:f.map(s=>{const t=Number(u)===s;return e.jsxs("button",{type:"button",onClick:()=>o(s),className:`rounded-xl border px-4 py-3 text-left shadow-sm transition focus:outline-none focus:ring-2 focus:ring-blue-200 ${t?"border-blue-600 bg-blue-50":"border-gray-200 bg-white hover:bg-gray-50"}`,children:[e.jsxs("div",{className:"text-lg font-bold text-gray-900",children:[s," XP"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"per day"})]},s)})}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"You can change this anytime."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:p,disabled:x,className:"rounded bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-700 disabled:opacity-60",children:x?"Saving...":"Save Goal"}),e.jsx("a",{href:"/courses",className:"text-sm text-gray-600 hover:text-gray-800",children:"Cancel"})]})]})})]})]})}export{k as default};
